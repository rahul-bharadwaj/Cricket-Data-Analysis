---
title: "WeRTidy"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.cap = "", fig.path = "Plot")
```

```{r Libraries, warning=FALSE, echo=FALSE}
library(tidyverse)
library(ggpubr)
library(ggplot2)
library(plotly)
library(knitr)
library(gridExtra)
library(kableExtra)
library(cricketdata)
```

# Introduction
This report aims at deducing the quality of batsmen in cricket from around the globe. The data used for this purpose is downloaded from the R package "cricketdata" from the following link - [Cricket Data Source.](https://docs.ropensci.org/cricketdata/) Data on all international cricket matches is provided by ESPNCricinfo. This package provides some scraper functions to download the data into tibbles ready for analysis. For the purpose of the assignment, this data is trimmed to suit our needs and consists of only 5 variables and 500 observations.

We can install cricketdata from github with:
```{r GitHubData, eval=FALSE, warning=FALSE}
install.packages("devtools")
devtools::install_github("ropenscilabs/cricketdata")
```

We are looking at only a subset of this data using the following lines of code:
```{r Data, cache=TRUE, warning=FALSE}
cric_bat_data <- fetch_cricinfo("ODI", "Men", "Batting", "Career") %>% select(-Country)
cric_bowl_data <- fetch_cricinfo("ODI", "Men", "Bowling", "Career") %>% select(-Country)
cric_field_data <- fetch_cricinfo("ODI", "Men", "Fielding", "Career") %>% select(-Country)
```

Once this data has been processed into a Comma Seperated Value file (csv), the rows and columns are trimmed according to the needs of the analysis.

The concise data is read from the csv file as follows -
```{r Tidying}
field_data_tidy <- separate(cric_field_data,
                            col = "Player",
                            into = c("Player", "Region"),
                            sep = "[*(*]"
)

bowl_data_tidy <- separate(cric_bowl_data,
                            col = "Player",
                            into = c("Player", "Region"),
                            sep = "[*(*]"
)

bat_data_tidy <- separate(cric_bat_data,
                            col = "Player",
                            into = c("Player", "Region"),
                            sep = "[*(*]"
)

bat_data <- bat_data_tidy %>% select(-Region)
bowl_data <- bowl_data_tidy %>% select(-Region)
field_data <- field_data_tidy %>% select(-Region)
field_data
```
```{r WriteCSV}
write.csv(bat_data, file = "Batting.csv")
write.csv(bowl_data, file = "Bowling.csv")
write.csv(field_data, file = "Fielding.csv")
```


```{r PlotsAvg, eval = FALSE}
plot1 <- ggplot(data = top_avg, aes( x = Player, y = Average )) +
  geom_bar(stat = "identity", fill = "blue") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + coord_flip()
```

```{r PlotsSR, eval = FALSE}
plot2 <- ggplot(data = top_sr, aes( x = Player, y = StrikeRate )) +
  geom_bar(stat = "identity", fill = "black") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + coord_flip()
```
**Let us compare the two Plots -**
```{r eval = FALSE, PlotCompare, fig.cap= "Comparing Averages and Strike Rates of top players"}
ggarrange(plot1, plot2)
```

**Let's look at the number of hundreds scored by players who has scored a minimum of 15 centuries.**
```{r eval = FALSE, DotPlot, fig.cap="Hundreds scored by players"}
p <- ggplot(data = top_century, aes( x = Player, y = Hundreds )) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + coord_flip()

ggplotly(p)

```


