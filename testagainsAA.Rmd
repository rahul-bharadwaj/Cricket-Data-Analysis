---
title: "What's your Fantasy Cricket Team?"
output: 
  flexdashboard::flex_dashboard: 
    orientation: columns
    vertical_layout: fill
    runtime: shiny
    
    
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(fig.cap = "", fig.path = "Plot", fig.align = 'center')
```

```{r Libraries, warning=FALSE, echo=FALSE, message=FALSE}
library(tidyverse)
library(ggpubr)
library(plotly)
library(knitr)
library(gridExtra)
library(cricketdata)
library(geomnet)
library(readr)
#library(rtweet)
```

```{r ReadData}
bat_data <- read.csv(here::here("Data/Tidy/Batting.csv"))
bowl_data <- read.csv(here::here("Data/Tidy/Bowling.csv"))
field_data <- read.csv(here::here("Data/Tidy/Fielding.csv"))
```


```{r Calculate, warning=FALSE, message=FALSE}
top_bat_data <- bat_data %>% filter(Matches>100) %>% 
   mutate(BattingQuality = (Runs/BallsFaced) * Innings,
          diff = (BattingQuality-Innings),
          Player=as.character(Player)) %>% 
          arrange(desc(diff)) %>%
          drop_na() %>% 
          rename(BattingAverage=Average,
          BattingStrikerate=StrikeRate, NetPerformance=diff)

top_bowl_data <- bowl_data %>% filter(Matches>100) %>% 
  mutate(BowlingEfficiency = Wickets/Innings,
         Player = as.character(Player))  %>%
         rename(Bowling_Average=Average,
         BowlingStrikerate=StrikeRate)

top_field_data <- field_data %>% filter(Matches>100) %>% 
  mutate(FieldingEfficiency=Dismissals/Innings,
  KeepingAbility=(Stumped+CaughtBehind)/Innings,
  Player=as.character(Player)) %>%
  mutate(WicketDissmissal = CaughtBehind + Stumped)

```

Storyboard
=====================================  

Row
-------------------------------------


### __For the Fans__

Cricket is an international sport watched throughout the world, played on every continent, with fans in every country. Internationally cricket matches are played as a series of test matches, ODI’s, T20s and World cup. Coming down to it World cups or rather the World cup trophies are the talk of the town. Hence, our main focus will be on ODIs. Now for the fans out there what would be your pick for your team entering the World cup.  So the real question is, which stats do you think are important while picking a team COACH?





### __Our Motivation__




In the midst of the epidemic, 4 friends started a discussion about a common sport, Cricket, with Rahul being the die-hard fan, Aarathy, a fan limited to popular opinion and social trends, Soban who only knew as much as the grapevines allowed, while Ed was hearing about it as a revelation.

Talking about this had Rahul on edge, Aarathy kept using Twitter followers and likes on photographs to tell which cricketer is better. Soban, on the other hand, used memes and grapevines to justify his choice of players in each category. Ed went through google and youtube to understand the game process and found some dataset about player stats around the world. This did not make sense to Rahul, he was using cold hard facts to support his choice but he had no output display that was very convincing to the others. Rahul had a sense of determination, knowledge of using data and a platform to make it visually appealing. He used the data set Ed found to build the best Fantasy Cricket Team, the 4 of them got invested in it like if it was a project.




Row {.tabset}
-------------------------------------
### __Data__



The data used is downloaded from the R package “cricketdata” from the following link - Cricket Data Source. Data on all international cricket matches is provided by ESPNCricinfo. This package provides some scraper functions to download the data into tibbles ready for analysis. You can access all the information from ESPNcricinfo. 



### __Data_Cleaning__

-The data we got had a lot of inconsistencies and missing values.

-To tidy it we separated the additional information that was provided in the name column. 

-We took out variables such as country and region to take out biases. ( it's about the player not the nationality)

-We mutated some new variables such as Batting Quality, Net Performance, Bowling efficiency, Fielding efficiency, keeping ability and wicket dismissal.



### __How to?__

For picking your dream team use the drop down menu to select the stat you think is more relevant for each category of player. Get the best team you think for your One Day International Cricket. 
There are different stats specified in for batting, bowling, wicket keeping and fielding. 
Batting, Bowling and wicket keeping is the crux of the dream team fielding on the other hand is to check how overall your team is in fielding. 
If you find it hard to understand the stats displayed please use the
[__Cheat Sheet__](#page-1)


### __Cheat Sheet__




Batsmen
=====================================  



Sidebar {.sidebar}
-----------------------------------------------------------------------


```{r Batsmen}

varSelectInput("batv", label = "Choose Variable:",
             top_bat_data, selected = "BattingAverage" )
 
varSelectInput("batv2", label = "Choose Variable:",
            top_bat_data, selected = "BattingStrikerate")

```
 

Not sure about the stats and what they are: LOOK HERE [__Cheat Sheet__](#page-1)



Row
-------------------------------------


### Expert's Choice

```{r CalculateBat}

plot_bat <-  top_bat_data %>% 
  ggplot(aes(x=NetPerformance,y=BattingAverage,color=Player)) + 
  geom_point()+ 
  geom_vline(xintercept = 0, color = "red") + theme(legend.position = "none")
  ggplotly(plot_bat)
```


### Your batsmen

```{r Bat plot}

selected_var1 <- reactive({
  sym(input$batv)
})
selected_var2 <- reactive({
  sym(input$batv2)
})
  
 renderPlotly({
    browser()
   var <- selected_var1()
     var2 <- selected_var2()
  
   p <-  ggplot(top_bat_data,aes(x=!!var,y=!!var2,color=Player)) + 
  geom_point()+ 
  geom_vline(xintercept = 0, color = "red")+theme(legend.position = "none")
  p  
}
)
```





Bowlers
=====================================  

Sidebar {.sidebar}
-----------------------------------------------------------------------

```{r Bowlers}

varSelectInput("bowlv", label = "Choose Variable:",
             top_bowl_data, selected = "Bowling_Average" )
 
varSelectInput("bowlv2", label = "Choose Variable:",
            top_bowl_data, selected = "Economy")

```

Not sure about the stats and what they are: LOOK HERE [__Cheat Sheet__](#page-1)

Row
-------------------------------------


### Expert's Choice

```{r Expert Bowlers}

plot_bowl <-  top_bowl_data %>% 
  ggplot(aes(x=BowlingEfficiency,y=Economy,color=Player)) + 
  geom_point()+ 
  geom_vline(xintercept = 0, color = "red") + theme(legend.position = "none")
  ggplotly(plot_bowl)
  
```


### Your bowlers


```{r Your Bowler}

selected_bowlvar1 <- reactive({
  sym(input$bowlv)
})
selected_bowlvar2 <- reactive({
  sym(input$bowlv2)
})
  
 renderPlotly({
    browser()
   bowlvar <- selected_bowlvar1()
     bowlvar2 <- selected_bowlvar2()
  
   pbowl <-  ggplot(top_bowl_data,aes(x=!!bowlvar,y=!!bowlvar2,color=Player)) + 
  geom_point()+ 
  geom_vline(xintercept = 0, color = "red")+theme(legend.position = "none")
  pbowl  
}
)
```






Wicket Keepers
=====================================  

Sidebar {.sidebar}
-----------------------------------------------------------------------

```{r Wicket keeper}

wicketkeeper_characteristics <- top_field_data %>% select(Matches,Innings,
                                                          Caught,CaughtBehind,
                                                          Stumped,MaxDismissalsInnings,KeepingAbility)

varSelectInput("wicketv", label = "Choose Variable:",
            wicketkeeper_characteristics , selected = "Innings" )
 
varSelectInput("wicketv2", label = "Choose Variable:",
            wicketkeeper_characteristics, selected = "CaughtBehind")


```

Not sure about the stats and what they are: LOOK HERE [__Cheat Sheet__](#page-1)


Row
-------------------------------------

### Expert's Choice



```{r Experts wicket keeper}

plot_wk <- top_field_data %>% filter(Stumped > 0, CaughtBehind > 0) %>% 
  ggplot(aes(x = KeepingAbility, y = Innings, color = Player))+
  geom_point()+
  geom_vline(xintercept = 1, color = "red")+theme(legend.position = "none")
  
ggplotly(plot_wk)
  
```



### Your wicket keepers

```{r Your wicket keeper}

selected_wicketvar1 <- reactive({
  sym(input$wicketv)
})
selected_wicketvar2 <- reactive({
  sym(input$wicketv2)
})
  
 renderPlotly({
    browser()
   wicketvar <- selected_wicketvar1()
     wicketvar2 <- selected_wicketvar2()
  
   p <- top_field_data %>% filter(Stumped > 0, CaughtBehind > 0) %>% 
       ggplot(aes(x=!!wicketvar,y=!!wicketvar2,color=Player)) + 
  geom_point()+ 
  geom_vline(xintercept = 1, color = "red")+theme(legend.position = "none")
  p  
}
)
 
 
 
```

Fielders
=====================================  

Sidebar {.sidebar}
-----------------------------------------------------------------------


```{r Fielders}

fielder_characteristics <- top_field_data %>% select(Matches,Innings,
                                                     Dismissals,CaughtFielder,
                                                     MaxDismissalsInnings,FieldingEfficiency)
  
  

  
varSelectInput("fieldv", label = "Choose Variable:",
           fielder_characteristics, selected = "Innings" )
 
varSelectInput("fieldv2", label = "Choose Variable:",
            fielder_characteristics, selected = "Dismissals")

```

Not sure about the stats and what they are: LOOK HERE [__Cheat Sheet__](#page-1)


Row
-------------------------------------

### Expert's Choice

```{r Experts fielders}

plot_field <- top_field_data %>% filter(Stumped == 0, CaughtBehind ==0) %>% 
  ggplot(aes(x = FieldingEfficiency, y = Innings, color = Player))+
  geom_point()+
  geom_vline(xintercept = 0.4, color = "red")+ theme(legend.position = "none") 
  
ggplotly(plot_field)
  
```

### Your Fielders

```{r Your fielder}

selected_fieldvar1 <- reactive({
  sym(input$fieldv)
})
selected_fieldvar2 <- reactive({
  sym(input$fieldv2)
})
  
 renderPlotly({
    browser()
   fieldvar <- selected_fieldvar1()
     fieldvar2 <- selected_fieldvar2()
  
   pf <- top_field_data %>% filter(Stumped == 0, CaughtBehind == 0) %>% 
       ggplot(aes(x=!!fieldvar,y=!!fieldvar2,color=Player)) + 
  geom_point()+ 
  geom_vline(xintercept = 0.4, color = "red")+theme(legend.position = "none")
  pf  
}
)
 
 
 
```




All rounders
=====================================  

Sidebar {.sidebar}
-----------------------------------------------------------------------

```{r All rounders}
bat_bowl <- top_bat_data %>% filter(Matches>100) %>% 
  inner_join(top_bowl_data, by = "Player") %>% 
  select(Player, BowlingEfficiency, NetPerformance, BattingAverage, BattingQuality) 

bat_bowl_battingchara <- bat_bowl %>% select(Player,BattingQuality,BattingAverage)
bat_bowl_bowlingchara <- bat_bowl %>% select(Player,NetPerformance,BowlingEfficiency)

varSelectInput("batbowlv", label = "Choose Bowling Characteristic for all rounders:",
             bat_bowl_bowlingchara, selected = "NetPerformance" )
 
varSelectInput("batbowlv2", label = "Choose Batting Characteristic for all rounders:",
            bat_bowl_battingchara, selected = "BattingQuality")

top_100_field <- top_field_data %>% filter(Matches>100)

bat_field <- top_bat_data %>% filter(Matches>100) %>% 
  inner_join(top_100_field,by = "Player") %>% arrange(desc(BattingAverage))%>% 
  rename(BattingInnings=Innings.x,
         WicketInnings=Innings.y)

bat_field_battingchara <- bat_field %>% select(Player,BattingInnings,
                                               Runs,NotOuts,HighScore,
                                               HighScoreNotOut,BattingAverage,
                                               BattingStrikerate,Ducks,
                                               Hundreds,Fifties,BattingQuality,NetPerformance)

bat_field_wicketchara <- bat_field %>% select(-c(BattingInnings,
                                               Runs,NotOuts,HighScore,
                                               HighScoreNotOut,BattingAverage,
                                               BattingStrikerate,Ducks,
                                               Hundreds,Fifties,BattingQuality,NetPerformance,
                                               Start.y,End.y,Matches.y,
                                               Matches.x,Start.x,End.x))  




varSelectInput("wicketbatv", label = "Choose Keeping Characteristic for Wicket Keeper + Batsmen:",
             bat_field_wicketchara, selected = "Dismissals" )
 
varSelectInput("wicketbatv2", label = "Choose Batting Characteristic for Wicket Keeper + Batsmen:",
            bat_field_battingchara, selected = "BattingQuality")



```

Not sure about the stats and what they are: LOOK HERE [__Cheat Sheet__](#page-1)

Row 
-------------------------------------


### Expert's Choice

```{r Experts all rounders, fig.height=7, fig.width=40}
plot_batbowl <- bat_bowl %>% 
  ggplot(aes(y=BattingAverage, x=BowlingEfficiency, color=Player))+
  geom_point()+geom_vline(xintercept = 0, color="red") + theme(legend.position = "none") +
  xlab("Bowling Efficiency") +
  ylab("Batting Average")

ggplotly(plot_batbowl)

```


### Your All rounders

```{r Your all rounders, fig.height=7, fig.width=40}

selected_batbowlvar1 <- reactive({
  sym(input$batbowlv)
})
selected_batbowlvar2 <- reactive({
  sym(input$batbowlv2)
})
  
 renderPlotly({
    browser()
   batbowlvar <- selected_batbowlvar1()
     batbowlvar2 <- selected_batbowlvar2()
  
   pbatbowl <- bat_bowl %>% 
       ggplot(aes(x=!!batbowlvar,y=!!batbowlvar2,color=Player)) + 
  geom_point()+ 
  geom_vline(xintercept = 0, color = "red")+theme(legend.position = "none")
  pbatbowl  
}
)
 
 
 
```


Column {.tabset}
----------------------------------------------





Row 
-------------------------------------

### Expert's Choice

```{r Experts choice, fig.height=7, fig.width=40}
plot_batfield <- bat_field %>% 
  ggplot(aes(y = BattingAverage, x = KeepingAbility, color = Player))+
  geom_point() + geom_vline(xintercept = 0, color = "red") + theme(legend.position = "none")

ggplotly(plot_batfield)
```




### Your Wicketkeeper + Batsmen

```{r Your wicket keeper + batsman, fig.height=7, fig.width=40}

selected_wicketbatvar1 <- reactive({
  sym(input$wicketbatv)
})
selected_wicketbatvar2 <- reactive({
  sym(input$wicketbatv2)
})
  
 renderPlotly({
    browser()
   wicketbatvar <- selected_wicketbatvar1()
     wicketbatvar2 <- selected_wicketbatvar2()
  
   pwicketbat <- bat_field %>% 
       ggplot(aes(x=!!wicketbatvar,y=!!wicketbatvar2,color=Player)) + 
  geom_point()+ 
  geom_vline(xintercept = 0, color = "red")+theme(legend.position = "none")
  pwicketbat  
}
)
 
 
 
```



Individual Player Stats
=====================================  


Column {.tabset}
-------------------------------------


### Expert's Batsmen Analysis


```{r Individual BatsmenPlots, echo=FALSE, fig.height=12, fig.width=8}
#Virat Kohli
vk <- fetch_player_data(253802, matchtype = "ODI", activity = "batting") %>% 
  mutate(NotOut = (Dismissal == "not out"))

vkavg <- vk %>% summarise(Innings = sum(!is.na(Runs)),
                          Average = sum(Runs, na.rm=TRUE) / (Innings - sum(NotOut, na.rm = TRUE))
                          ) %>% pull(Average)

ViratKohli <- vk %>% filter(Start_Date > "2017-01-01") %>% 
  ggplot() +
  geom_point(aes(x = Start_Date, y = Runs, color = NotOut)) +
  geom_hline(yintercept = vkavg) +
  ggtitle("Virat Kohli ODI Scores") +
  xlab("Date")

#AB de Villiers
abd <- fetch_player_data(44936, matchtype = "ODI", activity = "batting") %>% 
  mutate(NotOut = (Dismissal == "not out"))

abdavg <- abd %>% summarise(Innings = sum(!is.na(Runs)),
                          Average = sum(Runs, na.rm=TRUE) / (Innings - sum(NotOut, na.rm = TRUE))
                          ) %>% pull(Average)

ABdeVilliers <- abd %>% filter(Start_Date > "2017-01-01") %>% 
  ggplot() +
  geom_point(aes(x = Start_Date, y = Runs, color = NotOut)) +
  geom_hline(yintercept = abdavg) +
  ggtitle("AB de Villiers ODI Scores") +
  xlab("Date")

#Jos Buttler
jos <- fetch_player_data(308967, matchtype = "ODI", activity = "batting") %>% 
  mutate(NotOut = (Dismissal == "not out"))

josavg <- jos %>% summarise(Innings = sum(!is.na(Runs)),
                          Average = sum(Runs, na.rm=TRUE) / (Innings - sum(NotOut, na.rm = TRUE))
                          ) %>% pull(Average)

JosButtler <- jos %>% filter(Start_Date > "2017-01-01") %>% 
  ggplot() +
  geom_point(aes(x = Start_Date, y = Runs, color = NotOut)) +
  geom_hline(yintercept = josavg) +
  ggtitle("Jos Buttler ODI Scores") +
  xlab("Date")

#David Warner
war <- fetch_player_data(219889, matchtype = "ODI", activity = "batting") %>% 
  mutate(NotOut = (Dismissal == "not out"))

waravg <- war %>% summarise(Innings = sum(!is.na(Runs)),
                          Average = sum(Runs, na.rm=TRUE) / (Innings - sum(NotOut, na.rm = TRUE))
                          ) %>% pull(Average)

DavidWarner <- war %>% filter(Start_Date > "2017-01-01") %>% 
  ggplot() +
  geom_point(aes(x = Start_Date, y = Runs, color = NotOut)) +
  geom_hline(yintercept = waravg) +
  ggtitle("David Warner ODI Scores") +
  xlab("Date")

#David Miller
mil <- fetch_player_data(321777, matchtype = "ODI", activity = "batting") %>% 
  mutate(NotOut = (Dismissal == "not out"))

milavg <- mil %>% summarise(Innings = sum(!is.na(Runs)),
                          Average = sum(Runs, na.rm=TRUE) / (Innings - sum(NotOut, na.rm = TRUE))
                          ) %>% pull(Average)

DavidMiller <- mil %>% filter(Start_Date > "2017-01-01") %>% 
  ggplot() +
  geom_point(aes(x = Start_Date, y = Runs, color = NotOut)) +
  geom_hline(yintercept = milavg) +
  ggtitle("David Miller ODI Scores") +
  xlab("Date")

#Shane Watson
wat <- fetch_player_data(321777, matchtype = "ODI", activity = "batting") %>% 
  mutate(NotOut = (Dismissal == "not out"))

watavg <- wat %>% summarise(Innings = sum(!is.na(Runs)),
                          Average = sum(Runs, na.rm=TRUE) / (Innings - sum(NotOut, na.rm = TRUE))
                          ) %>% pull(Average)

ShaneWatson <- wat %>% filter(Start_Date > "2017-01-01") %>% 
  ggplot() +
  geom_point(aes(x = Start_Date, y = Runs, color = NotOut)) +
  geom_hline(yintercept = watavg) +
  ggtitle("Shane Watson ODI Scores") +
  xlab("Date")
```

```{r Grid1, fig.height=8, fig.width=12, warning=FALSE, echo=FALSE, message=FALSE, fig.align='center'}
grid.arrange(ViratKohli, ABdeVilliers, JosButtler, DavidWarner, DavidMiller, ShaneWatson)
```


### Expert's Bowlers

```{r Individuals BowlersPlots, echo=FALSE}
#Eonomies
econ <- top_bowl_data %>% dplyr::filter(Player %in% c("B Lee ", "Saqlain Mushtaq ", "AA Donald 	","Imran Tahir ", "M Morkel ", "Waqar Younis ", "JH Kallis ", "Shakib Al Hasan ")) %>%
  ggplot(aes( x = Player, y = Economy )) +
  geom_bar(stat = "identity", fill = "deepskyblue3") +
  theme(axis.text.x = element_text(hjust = 1)) + coord_flip()

#Wickets
wkts <- top_bowl_data %>% dplyr::filter(Player %in% c("B Lee ", "Saqlain Mushtaq ", "AA Donald 	","Imran Tahir ", "M Morkel ", "Waqar Younis ", "JH Kallis ", "Shakib Al Hasan ")) %>%
  ggplot(aes( x = Player, y = Wickets )) +
  geom_bar(stat = "identity", fill = "brown") +
  theme(axis.text.x = element_text(hjust = 1)) + coord_flip()

#BowlingAverage
bowlavg <- top_bowl_data %>% dplyr::filter(Player %in% c("B Lee ", "Saqlain Mushtaq ", "AA Donald 	","Imran Tahir ", "M Morkel ", "Waqar Younis ", "JH Kallis ", "Shakib Al Hasan ")) %>%
  ggplot(aes( x = Player, y = Bowling_Average)) +
  geom_bar(stat = "identity", fill = "forestgreen") +
  theme(axis.text.x = element_text(hjust = 1)) + coord_flip()

#BowlingEfficiency
bowlef <- top_bowl_data %>% dplyr::filter(Player %in% c("B Lee ", "Saqlain Mushtaq ", "AA Donald 	","Imran Tahir ", "M Morkel ", "Waqar Younis ", "JH Kallis ", "Shakib Al Hasan ")) %>%
  ggplot(aes( x = Player, y = BowlingEfficiency)) +
  geom_bar(stat = "identity", fill = "orange") +
  theme(axis.text.x = element_text(hjust = 1)) + coord_flip()
```

```{r Grid2,warning=FALSE, echo=FALSE, message=FALSE, fig.align='center', fig.height=12, fig.width=12}
grid.arrange(econ, wkts, bowlavg, bowlef)
```


### Expert's Keepers



```{r individual KeepersPlots, echo=FALSE, message=FALSE, warning=FALSE}
#dismissals
keepdismissal <- top_field_data %>% dplyr::filter(Player %in% c("Q de Kock ", "JC Buttler ")) %>%
  ggplot(aes( x = Player, y = Dismissals)) +
  geom_bar(stat = "identity", fill = "deepskyblue3") +
  theme(axis.text.x = element_text(hjust = 1)) + coord_flip()

#keepcaught
keepcaught <- top_field_data %>% dplyr::filter(Player %in% c("Q de Kock ", "JC Buttler ")) %>%
  ggplot(aes( x = Player, y = CaughtBehind)) +
  geom_bar(stat = "identity", fill = "brown") +
  theme(axis.text.x = element_text(hjust = 1)) + coord_flip()

#keepstump
keepstump <- top_field_data %>% dplyr::filter(Player %in% c("Q de Kock ", "JC Buttler ")) %>%
  ggplot(aes( x = Player, y = Stumped)) +
  geom_bar(stat = "identity", fill = "forestgreen") +
  theme(axis.text.x = element_text(hjust = 1)) + coord_flip()

#keepability
keepability <- top_field_data %>% dplyr::filter(Player %in% c("Q de Kock ", "JC Buttler ")) %>%
  ggplot(aes( x = Player, y = KeepingAbility)) +
  geom_bar(stat = "identity", fill = "orange") +
  theme(axis.text.x = element_text(hjust = 1)) + coord_flip()
```

```{r Grid3, warning=FALSE, echo=FALSE, message=FALSE, fig.align='center',  fig.height=12, fig.width=12}
grid.arrange(keepdismissal, keepcaught, keepstump, keepability)
```


Captain
=====================================  


Sidebar {.sidebar}
-----------------------------------------------------------------------


Row
-------------------------------------

```{r ReadTwitterData, echo=FALSE, message=FALSE, warning=FALSE}
#read_twitter_csv("followinglist.csv",unflatten = FALSE)
followinglist <- read_csv("Data/followinglist.csv")
```

```{r Network, echo=FALSE, message=FALSE, warning=FALSE}
listfollowing <- followinglist %>% select(user,user_id,screen_name) 
network <- listfollowing %>% select(user,screen_name) %>% filter(screen_name %in% c("imVkohli","ABdeVilliers17","josbuttler","davidwarner31","DavidMillerSA12","BrettLee_58
","Saqlain_Mushtaq","AllanDonald33","ImranTahirSA","mornemorkel65","waqyounis99","QuinnyDeKock69","Sah75official","ShaneRWatson33","jacqueskallis75"))

pop_score <- network %>% 
  group_by(screen_name) %>% count(screen_name)%>% arrange(desc(n))
```

```{r NetworkPlot, fig.width=10, echo=FALSE}
set.seed(5556677)
pnetwork <- ggplot(data = network,
 aes(from_id = user,
 to_id = screen_name)) +
 geom_net(aes(group=user), layout.alg = "kamadakawai",
          colour = "blue",
         fiteach=T, directed = T, size = 4, linewidth = .5, arrowgap = 0.02,
           ealpha = .5, labelon = T, fontsize = 3, repel = T, 
           labelcolour = "black", arrowsize = .5, singletons = FALSE
        ,ecolour = "#154C07"
         ) +
 theme_net()

pnetwork
```




